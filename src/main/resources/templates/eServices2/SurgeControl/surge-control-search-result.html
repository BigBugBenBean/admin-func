<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout">
<head>
    <meta charset="UTF-8"></meta>
    <title>e-Services Admin Function</title>

    <link rel="stylesheet" href="/adminfunc/css/surge-control.css"/>

    <script th:inline="javascript" th:if="${surgeControlViewDTO}">
         /*<![CDATA[*/

         $(function () {

            var surgeControlViewDTO = [[${surgeControlViewDTO}]];
            console.log('surgeControlViewDTO');
            console.log(surgeControlViewDTO);

            var list = [];

            if (isNotEmptyNullUndfined(surgeControlViewDTO)) {
                var surgeControlViewList    = surgeControlViewDTO['surgeControlViewList'];
                var appId                   = surgeControlViewDTO['appId'];
                var gst                     = surgeControlViewDTO['gst'];
                var description             = surgeControlViewDTO['description'];
                var mst                     = surgeControlViewDTO['mst'];
                var priority                = surgeControlViewDTO['priority'];
                var clawback                = surgeControlViewDTO['clawback'];

                if (isNotEmptyNullUndfined(appId)) {
                    var appIdDom = $('#appId');
                    appIdDom.html(appId);
                }
                if (isNotEmptyNullUndfined(gst)) {
                    var gstExpDom = $('#gst');
                    gstDom.html(gst);
                }
                if (isNotEmptyNullUndfined(description)) {
                    var descriptionDom = $('#description');
                    descriptionDom.html(description);
                }
                if (isNotEmptyNullUndfined(mst)) {
                    var mstDom = $('#mst');
                    mstDom.html(mst);
                }
                if (isNotEmptyNullUndfined(priority)) {
                    var priorityDom = $('#priority');
                    priorityDom.html(priority);
                }
                if (isNotEmptyNullUndfined(clawback)) {
                    var clawbackDom = $('#clawback');
                    clawbackDom.html(clawback);
                }
            }

            /*
            list = [
                {
                    'appId': '01',
                    'gst': '1',
                    'description': 'Sample Description',
                    'mst': '1',
                    'priority': '1',
                    'clawback': ''
                }
            ];
            */

            // table grid data
            var totalPageList = GRID_RECORD_PER_PAGE_ARRAY_DEFAULT;
            var recordPerPage = totalPageList[0];

            // table grid record per page
            var totalPager = $('#totalPager');
            totalPager.on('change', function () {
                recordPerPage = $(this).val();

                var tmpNumSize = getGridPageNumSize(recordPerPage, list.length);
                generateSelectOptionBySequence(numPager, tmpNumSize, GRID_TABLE_OFFSET);

                grid.jsGrid('option', 'pageSize', recordPerPage);
            });

            // table grid page number
            var numPager = $('#numPager');
            numPager.on('change', function () {
                var val = $(this).val();
                var page = parseInt(val, 10);

                grid.jsGrid('openPage', page);
            });

            //
            generateSelectOptionByValue(totalPager, totalPageList, false);

            var numSize = getGridPageNumSize(recordPerPage, list.length);
            generateSelectOptionBySequence(numPager, numSize, GRID_TABLE_OFFSET);

            // grid
            var grid = $("#surgeControlGrid");
            var gridConfig = {
                width: '100%',
                height: '260px',

                sorting: true,
                noDataContent: 'NO data',
                selecting: false,

                autoload: true,

                paging: true,
                pageLoading: true,
                pageSize: recordPerPage,

                controller: {
                    loadData: function (filter) {
                        var startIndex = (filter.pageIndex - 1) * filter.pageSize;
                        return {
                            data: list.slice(startIndex, startIndex + filter.pageSize),
                            itemCount: list.length
                        };
                    }
                },
                fields: [
                    { name: 'appId', title: 'App ID', type: 'text', width: 40, headerTemplate: commonHeader },
                    { name: 'gst', title: 'GST', type: 'text', width: 40, headerTemplate: commonHeader },
                    { name: 'description', title: 'Description', type: 'text', width: 30, headerTemplate: commonHeader },
                    { name: 'mst', title: 'MST', type: 'text', width: 30, headerTemplate: commonHeader },
                    { name: 'priority', title: 'Priority', type: 'text', width: 40, headerTemplate: commonHeader },
                    { name: 'clawback', title: 'Clawback', type: 'text', width: 40, headerTemplate: commonHeader }
                ]

            };
            grid.jsGrid(gridConfig);
        });


         /*]]>*/
    </script>

</head>
<body>
<div>


    <div layout:fragment="header(${ROOT})"></div>

    <div layout:fragment="content" style="">
        <div class="content-padding">
            <div>
                <h3 th:text="${#messages.msg('umps.adminfunc.surgecontrol.main.search.result')}"></h3>
                <div class="RowSeparator">
                </div>

                <div class="flex-container">
                    <div class="flex-item-2 search-result-left"><b><span th:text="${#messages.msg('umps.adminfunc.surgecontrol.main.appid')}"></span></b></div>
                    <div class="flex-item-7 search-result-right">
                        <span id="appid"></span>
                    </div>
                </div>
                <div class="RowSeparatorThin"></div>
                <div class="flex-container">
                    <div class="flex-item-2 search-result-left"><b><span th:text="${#messages.msg('umps.adminfunc.surgecontrol.main.gst')}"></span></b></div>
                    <div class="flex-item-7 search-result-right">
                        <span id="gst"></span>
                    </div>
                </div>
                <div class="RowSeparatorThin"></div>
                <div class="flex-container">
                    <div class="flex-item-2 search-result-left"><b><span th:text="${#messages.msg('umps.adminfunc.surgecontrol.main.desc')}"></span></b></div>
                    <div class="flex-item-7 search-result-right">
                        <span id="desc"></span>
                    </div>
                </div>
                <div class="RowSeparatorThin"></div>
                <div class="flex-container">
                    <div class="flex-item-2 search-result-left"><b><span th:text="${#messages.msg('umps.adminfunc.surgecontrol.main.mst')}"></span></b></div>
                    <div class="flex-item-7 search-result-right">
                        <span id="mst"></span>
                    </div>
                </div>
                <div class="RowSeparatorThin"></div>
                <div class="flex-container">
                    <div class="flex-item-2 search-result-left"><b><span th:text="${#messages.msg('umps.adminfunc.surgecontrol.main.priority')}"></span></b></div>
                    <div class="flex-item-7 search-result-right">
                        <span id="priority"></span>
                    </div>
                </div>
                <div class="RowSeparatorThin"></div>
                <div class="flex-container">
                    <div class="flex-item-2 search-result-left"><b><span th:text="${#messages.msg('umps.adminfunc.surgecontrol.main.clawback')}"></span></b></div>
                    <div class="flex-item-7 search-result-right">
                        <span id="clawback"></span>
                    </div>
                </div>
                <div class="RowSeparator"></div>
            </div>

            <div style="margin-top: 1em;  ">
                <div class="flex-container grid-page-header">
                    <div style="flex: auto;"></div>
                    <div>
                        <span class="grid-page-header-text" th:text="${#messages.msg('umps.adminfunc.common.pagination.recordPerPage')}"></span>
                        <span>
                                <select id="totalPager"></select>
                            </span>
                        <span class="grid-page-header-text" style="padding-left: 10px;" th:text="${#messages.msg('umps.adminfunc.common.pagination.pageNo')}"></span>
                        <span>
                                <select id="numPager"></select>
                            </span>
                    </div>
                </div>
                <div>
                    <div id="scheduleJobGrid"></div>
                </div>
            </div>

            <div class="flex-container">
                <div style="flex: auto;"></div>
                <div style="padding: 15px;">
                    <a class="DisableLinkUnderline" th:href="@{/e-Services-2/maintenance/surgeControl.do}">
                        <input class="ButtonStyle back-button pointer" type="button" th:value="${#messages.msg('umps.adminfunc.common.backToSearchCriteria')}" />
                    </a>
                </div>

            </div>
        </div>
    </div>


</div>
</body>
</html>